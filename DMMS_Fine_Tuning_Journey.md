# DMMS.R Fine-Tuning Journey: G2P2C ê°•í™”í•™ìŠµ ë¯¸ì„¸ì¡°ì • í”„ë¡œì íŠ¸

## ëª©ì°¨
1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì´ˆê¸° ë¬¸ì œ ì¸ì‹](#ì´ˆê¸°-ë¬¸ì œ-ì¸ì‹)
3. [ë‹¤ì¤‘ í™˜ì í›ˆë ¨ ì‹œë„](#ë‹¤ì¤‘-í™˜ì-í›ˆë ¨-ì‹œë„)
4. [DMMS.R í™˜ê²½ ë¶„ì„](#dmmsr-í™˜ê²½-ë¶„ì„)
5. [í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” ì—¬ì •](#í•˜ì´í¼íŒŒë¼ë¯¸í„°-ìµœì í™”-ì—¬ì •)
6. [ì‹¤í—˜ ê²°ê³¼ ë° ë¶„ì„](#ì‹¤í—˜-ê²°ê³¼-ë°-ë¶„ì„)
7. [ìµœì¢… ì„±ê³¼ ë° ê²°ë¡ ](#ìµœì¢…-ì„±ê³¼-ë°-ê²°ë¡ )

---

## í”„ë¡œì íŠ¸ ê°œìš”

### ëª©í‘œ
- **Pre-trained G2P2C ì—ì´ì „íŠ¸**ë¥¼ Simglucose í™˜ê²½ì—ì„œ **DMMS.R í™˜ê²½ìœ¼ë¡œ ë¯¸ì„¸ì¡°ì •**
- **ì˜¨ë¼ì¸ ë¯¸ì„¸ì¡°ì •**: ì‹¤ì‹œê°„ìœ¼ë¡œ ì •ì±… ì—…ë°ì´íŠ¸ê°€ ê°€ëŠ¥í•œ ì‹œìŠ¤í…œ êµ¬ì¶•
- **ë‹¤ì¤‘ í™˜ì í™˜ê²½**: ì—¬ëŸ¬ í™˜ìì— ëŒ€í•œ ì¼ë°˜í™”ëœ í˜ˆë‹¹ ì œì–´ ì„±ëŠ¥ ë‹¬ì„±

### ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
```
Pre-trained G2P2C (Episode 195)
        â†“
Single-Process Architecture
        â†“
FastAPI Server â† â†’ DMMS.R Simulator
        â†“
JavaScript Plugin (5min intervals)
        â†“
Real-time Policy Updates
```

---

## ì´ˆê¸° ë¬¸ì œ ì¸ì‹

### í™˜ì ì„ íƒ ë° í›ˆë ¨ ë°©ì‹ íƒêµ¬

**ì´ˆê¸° ì§ˆë¬¸**: "í™˜ìë¥¼ ê³„ì† ë°”ê¾¸ëŠ” ê°•í™”í•™ìŠµì´ ê°€ëŠ¥í•œê°€?"

#### í˜„ì¬ ì‹œìŠ¤í…œ ë¶„ì„
- **ë‹¨ì¼ í™˜ì ê³ ì •**: `args.patient_id`ë¡œ í•˜ë‚˜ì˜ í™˜ìë§Œ ì„ íƒ
- **Worker ì˜êµ¬ ë°”ì¸ë”©**: í›ˆë ¨ ì¤‘ í™˜ì ë³€ê²½ ë¶ˆê°€ëŠ¥
- **DMMS.R ì œì•½**: ë‹¨ì¼ XML ì„¤ì •íŒŒì¼ ì˜ì¡´

#### í™˜ì êµì²´ êµ¬í˜„ ë°©ë²• íƒêµ¬
1. **ë°©ë²• A: ì—í”¼ì†Œë“œë³„ í™˜ì êµì²´**
   ```python
   def change_patient(self, patient_id):
       self.patient_name = self.patients[patient_id]
       self.env = get_env(self.args, patient_name=self.patient_name, ...)
   ```

2. **ë°©ë²• B: ë¡¤ì•„ì›ƒë³„ í™˜ì ìˆœí™˜**
   ```python
   for rollout in range(max_episodes):
       if rollout % 5 == 0:  # 5 ì—í”¼ì†Œë“œë§ˆë‹¤ í™˜ì êµì²´
           patient_id = (rollout // 5) % len(patients)
   ```

**ê²°ë¡ **: Simglucoseì—ì„œëŠ” ê°€ëŠ¥í•˜ì§€ë§Œ, **DMMS.Rì—ì„œëŠ” í”„ë¡œì„¸ìŠ¤ ì¬ì‹œì‘ í•„ìš”**

---

## ë‹¤ì¤‘ í™˜ì í›ˆë ¨ ì‹œë„

### Shell ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜ ìˆœì°¨ í›ˆë ¨

#### XML íŒŒì¼ êµ¬ì„±
ì‚¬ìš©ìê°€ ì—¬ëŸ¬ í™˜ìë³„ XML ì„¤ì •íŒŒì¼ì„ ìƒì„±:
- `RL_scenario_1_07_13_19_50_adult2.xml`
- `RL_scenario_1_07_13_19_50_adult8.xml`
- ë“± 9ëª…ì˜ ì„±ì¸ í™˜ì ì„¤ì •

#### ë©€í‹° í™˜ì í›ˆë ¨ ìŠ¤í¬ë¦½íŠ¸ ê°œë°œ
**íŒŒì¼**: `run_multi_patient_dmms_training.sh`

**ì£¼ìš” ê¸°ëŠ¥**:
- í™˜ìë³„ ìˆœì°¨ í›ˆë ¨ ì‹¤í–‰
- ê²°ê³¼ ìë™ ì§‘ê³„ ë° ì •ë¦¬
- ë¡œê¹… ë° ìµœì¢… ë³´ê³ ì„œ ìƒì„±

```bash
# ì‹¤í–‰ ì˜ˆì‹œ
declare -a PATIENTS=("adult002" "adult008")
declare -a CONFIG_FILES=("RL_scenario_1_07_13_19_50_adult2.xml" "RL_scenario_1_07_13_19_50_adult8.xml")
```

**ë¬¸ì œ ë°œìƒ**: Windows ì¤„ë°”ê¿ˆ ë¬¸ì(\r\n) ì˜¤ë¥˜
```bash
# í•´ê²° ë°©ë²•
sed -i 's/\r$//' run_multi_patient_dmms_training.sh
```

**ì‹¤í–‰ ê²°ê³¼**: ì„¤ì •íŒŒì¼ ê²½ë¡œ ë¬¸ì œë¡œ ì‹¤í–‰ ì¤‘ë‹¨
- **ì›ì¸**: WSLê³¼ Windows ê²½ë¡œ í˜¼ì¬
- **í•´ê²°**: ê²½ë¡œ í†µì¼ ë° íŒŒì¼ ì¡´ì¬ í™•ì¸ ë¡œì§ ê°œì„ 

---

## DMMS.R í™˜ê²½ ë¶„ì„

### í™˜ì ì„¤ì • ë° í›ˆë ¨ íŒŒì´í”„ë¼ì¸ ì´í•´

#### DMMS.R ì‹œìŠ¤í…œ êµ¬ì¡°
```
XML Config File (í™˜ì ì •ì˜)
        â†“
DMMS.R Process (ì‹œë®¬ë ˆì´ì…˜)
        â†“
JavaScript Plugin (5ë¶„ ê°„ê²©)
        â†“
FastAPI Server (/env_step)
        â†“
G2P2C Agent (ì‹¤ì‹œê°„ ì¶”ë¡ )
        â†“
Insulin Action (U/h)
```

#### í™˜ì ì •ë³´ ì¸ì½”ë”©
**XML ì„¤ì •íŒŒì¼ ë‚´ìš©**:
- **í™˜ì ìƒë¦¬í•™**: ì¸ìŠë¦° ë¯¼ê°ë„, í¬ë„ë‹¹ ëŒ€ì‚¬ìœ¨
- **ì‹ì‚¬ ì‹œë‚˜ë¦¬ì˜¤**: 07:00, 13:00, 19:00 (ê° 50g íƒ„ìˆ˜í™”ë¬¼)
- **ì´ˆê¸° ì¡°ê±´**: í˜ˆë‹¹ 120mg/dL, 24ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜
- **ì„¼ì„œ ì„¤ì •**: IdealCgmSensor, 5ë¶„ ê°„ê²©

#### ì‹¤ì‹œê°„ ë°ì´í„° êµí™˜
```javascript
// DMMS.R â†’ FastAPI
var payload = {
    "history": [[bg1,ins1], [bg2,ins2], ..., [bg12,ins12]], // 12 timesteps
    "meal": timeToNextMealSteps  // Meal announcement
};

// FastAPI â†’ DMMS.R
var response = {
    "insulin_action_U_per_h": 2.3,  // Agent decision
    "cgm": 120.5,                   // Current glucose
    "reward": 0.15,                 // Calculated reward
    "done": false                   // Episode continuation
};
```

---

## í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” ì—¬ì •

### ì´ˆê¸° í›ˆë ¨ ì‹œë„ ë° ë¬¸ì œ ë°œê²¬

#### ì‹¤í—˜ 1: 30 ì—í”¼ì†Œë“œ ê¸°ë³¸ ì„¤ì •
**ëª…ë ¹ì–´**:
```bash
python experiments/run_extended_dmms_training.py \
  --extended_episodes 30 \
  --fine_tune_from_checkpoint 195 \
  --dmms_cfg C:\Users\user\Desktop\G2P2C\config\RL_scenario_1_07_13_19_50_adult2.xml
```

**ì‚¬ìš©ëœ í•˜ì´í¼íŒŒë¼ë¯¸í„°** (`set_args_dmms_debug()`):
```python
args.pi_lr = 5e-5                  # ì •ì±… í•™ìŠµë¥ 
args.vf_lr = 5e-5                  # ê°€ì¹˜ í•¨ìˆ˜ í•™ìŠµë¥ 
args.batch_size = 256              # ë°°ì¹˜ í¬ê¸°
args.n_step = 64                   # ë¡¤ì•„ì›ƒ ê¸¸ì´
args.n_training_workers = 1        # ë‹¨ì¼ ì›Œì»¤
```

**ê²°ê³¼ íŒŒì¼**: `results/extended_dmms_30ep_20250607_154004/testing/data/testing_episode_summary_5000.csv`

**ë¬¸ì œ ë°œê²¬**: **RMSE ì§€ì†ì  ì¦ê°€**
- **aBGP_rmse**: 4.79 â†’ 8.45 mg/dL (77% ì•…í™”)
- **cBGP_rmse**: 5.17 â†’ 5.50 mg/dL (ì¤‘ê°„ì— 14.90ê¹Œì§€ ê¸‰ë“±)

#### ì‹¤í—˜ 2: 60 ì—í”¼ì†Œë“œ ì—°ì¥ í›ˆë ¨
**ê°€ì„¤**: "ë” ë§ì€ ì—í”¼ì†Œë“œë¡œ ìˆ˜ë ´í•  ê²ƒ"

**ê²°ê³¼ íŒŒì¼**: `results/extended_dmms_60ep_20250607_162625/testing/data/testing_episode_summary_5000.csv`

**ê²°ê³¼**: **ë” ì‹¬ê°í•œ ì„±ëŠ¥ ì €í•˜**
- **aBGP_rmse**: 5.03 â†’ 10.63 mg/dL (111% ì•…í™”)
- **cBGP_rmse**: 5.09 â†’ 5.78 mg/dL (ì¤‘ê°„ì— 16.16ê¹Œì§€ ê·¹ì•…)

**íŒ¨í„´ ê´€ì°°**:
- **ê·¹ì‹¬í•œ ë¶ˆì•ˆì •ì„±**: 5 â†’ 16 â†’ 5 mg/dL ë¡¤ëŸ¬ì½”ìŠ¤í„°
- **í¬ë¦¬í‹± ë„¤íŠ¸ì›Œí¬ ë°œì‚°**: ì¤‘ë°˜ë¶€ ì™„ì „ ë¶•ê´´ í›„ ê¸°ì ì  íšŒë³µ
- **TIR 100% ìœ ì§€**: ì œì–´ ì„±ëŠ¥ì€ ì–‘í˜¸í•˜ì§€ë§Œ ì˜ˆì¸¡ ì‹ ë¢°ì„± ë¬¸ì œ

### ê·¼ë³¸ ì›ì¸ ë¶„ì„

#### í•™ìŠµë¥  ê³¼ë‹¤ ë¬¸ì œ
```python
# ë¬¸ì œê°€ ëœ ì„¤ì •
args.pi_lr = 5e-5     # ì‚¬ì „í›ˆë ¨ëœ ëª¨ë¸ì—ëŠ” ë„ˆë¬´ ë†’ìŒ
args.vf_lr = 5e-5     # ë¶ˆì•ˆì •í•œ ê°€ì¤‘ì¹˜ ì—…ë°ì´íŠ¸ ì•¼ê¸°
```

#### ë°°ì¹˜ í¬ê¸° ë¶€ì¡±
```python
args.batch_size = 256  # ê·¸ë˜ë””ì–¸íŠ¸ ì¶”ì • ë…¸ì´ì¦ˆ ê³¼ë‹¤
```

#### DMMS.R í™˜ê²½ íŠ¹ìˆ˜ì„± ë¯¸ë°˜ì˜
- **ë‹¨ì¼ ì›Œì»¤ ì œì•½**: `n_training_workers = 1`
- **ì‹¤ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜**: ë¡¤ì•„ì›ƒ ê¸¸ì´ê°€ í™˜ê²½ì— ì˜í•´ ê²°ì •ë¨
- **í™˜ê²½ ë¶„í¬ ì°¨ì´**: Simglucose â†’ DMMS.R ì ì‘ ì‹¤íŒ¨

### ìŠ¤í¬ë¦½íŠ¸ ê°œì„ : ëª…ë ¹ì¤„ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì§€ì›

#### ë¬¸ì œì 
ê¸°ì¡´ `run_extended_dmms_training.py`ëŠ” í•˜ë“œì½”ë”©ëœ ê°’ë§Œ ì‚¬ìš©:
```python
# ìˆ˜ì • ì „: ê³ ì •ê°’ë§Œ ì‚¬ìš©
args = set_args_dmms_debug(args)  # ë‚´ë¶€ì—ì„œ pi_lr=5e-5 í•˜ë“œì½”ë”©
```

#### í•´ê²°ì±…: ëª…ë ¹ì¤„ ì¸ì ì¶”ê°€
```python
# ìˆ˜ì • í›„: ëª…ë ¹ì¤„ì—ì„œ ì¡°ì • ê°€ëŠ¥
parser.add_argument('--pi_lr', type=float, default=1e-5)
parser.add_argument('--vf_lr', type=float, default=1e-5)
parser.add_argument('--batch_size', type=int, default=512)
parser.add_argument('--dmms_cfg', type=str)
```

**ì˜¤ë²„ë¼ì´ë“œ ë¡œì§ ì¶”ê°€**:
```python
# set_args_dmms_debug() ì´í›„ ì‚¬ìš©ì ì„¤ì •ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë“œ
if hasattr(args, 'custom_pi_lr'):
    args.pi_lr = args.custom_pi_lr
    print(f"INFO: Overriding policy learning rate to: {args.pi_lr}")
```

---

## ì‹¤í—˜ ê²°ê³¼ ë° ë¶„ì„

### ì‹¤í—˜ 3: ìµœì í™”ëœ í•˜ì´í¼íŒŒë¼ë¯¸í„° (100 ì—í”¼ì†Œë“œ)

#### ì‹¤í–‰ ëª…ë ¹ì–´
```bash
python experiments/run_extended_dmms_training.py \
  --extended_episodes 100 \
  --fine_tune_from_checkpoint 195 \
  --dmms_cfg C:\Users\user\Desktop\G2P2C\config\RL_scenario_1_07_13_19_50_adult2.xml \
  --pi_lr 3e-5 \
  --vf_lr 3e-5 \
  --batch_size 1024
```

#### ìµœì í™”ëœ í•˜ì´í¼íŒŒë¼ë¯¸í„°
```python
pi_lr = 3e-5          # ì´ì „ 5e-5ì˜ 60% ìˆ˜ì¤€ (ë” ë³´ìˆ˜ì )
vf_lr = 3e-5          # ì´ì „ 5e-5ì˜ 60% ìˆ˜ì¤€ (ë” ë³´ìˆ˜ì )  
batch_size = 1024     # ì´ì „ 256ì˜ 4ë°° (ì•ˆì •ì  ê·¸ë˜ë””ì–¸íŠ¸)
```

#### ğŸ‰ ê·¹ì ì¸ ì„±ê³µ ê²°ê³¼!

**ê²°ê³¼ íŒŒì¼**: `results/extended_dmms_100ep_20250607_183216/testing/data/testing_episode_summary_5000.csv`

### ì„±ëŠ¥ ì§€í‘œ ë¶„ì„

#### RMSE ê°œì„  íŒ¨í„´
**Actor BG Prediction RMSE (aBGP_rmse)**:
```
Episode 2:  4.11 mg/dL (ì–‘í˜¸í•œ ì‹œì‘)
Episode 40: 8.76 mg/dL (ì¤‘ë°˜ ìƒìŠ¹)
ğŸ”¥ Episode 41: 3.81 mg/dL (ê¸‰ê²©í•œ ê°œì„ ! -56%)
Episode 101: 1.38 mg/dL (ìµœì¢… ìš°ìˆ˜! 66% ì¶”ê°€ ê°œì„ )
```

**Critic BG Prediction RMSE (cBGP_rmse)**:
```
Episode 2:  5.27 mg/dL
Episode 40: 17.05 mg/dL (ìµœì•…ì )
ğŸ”¥ Episode 41: 5.23 mg/dL (ê¸‰ê²©í•œ íšŒë³µ! -69%)
Episode 101: 1.64 mg/dL (ìµœì¢… ìš°ìˆ˜! 69% ì¶”ê°€ ê°œì„ )
```

#### 3ë‹¨ê³„ í•™ìŠµ ê³¼ì •
1. **Phase 1 (Episode 2-40)**: ë¶ˆì•ˆì •í•œ ì ì‘ ë‹¨ê³„
   - DMMS.R í™˜ê²½ íŠ¹ì„± íŒŒì•…
   - ì‚¬ì „í›ˆë ¨ëœ ê°€ì¤‘ì¹˜ì˜ ì ì§„ì  ì¡°ì •
   
2. **Phase 2 (Episode 41)**: ê¸‰ê²©í•œ ì„±ëŠ¥ ë„ì•½ (**ë¸Œë ˆì´í¬ìŠ¤ë£¨**)
   - ê°‘ì‘ìŠ¤ëŸ° RMSE ê¸‰ë½
   - ëª¨ë¸ì´ DMMS.R í™˜ê²½ì— ì™„ì „ ì ì‘
   
3. **Phase 3 (Episode 42-101)**: ì•ˆì •ì  ì§€ì† ê°œì„ 
   - ì§€ì†ì ì¸ ì„±ëŠ¥ í–¥ìƒ
   - ìµœì¢… 1-2 mg/dL ìˆ˜ì¤€ì˜ ìš°ìˆ˜í•œ ì˜ˆì¸¡ ì •í™•ë„

#### ì„ìƒ ì„±ëŠ¥ ìœ ì§€
- **TIR (Time in Range)**: 100% ì§€ì† ìœ ì§€
- **Hypoglycemia**: 0% (ì™„ë²½í•œ ì•ˆì „ì„±)
- **Hyperglycemia**: 0% (ìš°ìˆ˜í•œ ì œì–´)
- **Episode Reward**: 256-287 ë²”ìœ„ ì•ˆì •

---

## ìµœì¢… ì„±ê³¼ ë° ê²°ë¡ 

### ì„±ê³µ ìš”ì¸ ë¶„ì„

#### 1. ì ì ˆí•œ í•™ìŠµë¥  ì„¤ì •
```python
# ì„±ê³µí•œ ì„¤ì •
pi_lr = 3e-5    # ì‚¬ì „í›ˆë ¨ëœ ëª¨ë¸ì— ì í•©í•œ ë³´ìˆ˜ì  ì„¤ì •
vf_lr = 3e-5    # ë°œì‚° ë°©ì§€, ì•ˆì •ì  ìˆ˜ë ´ ë³´ì¥
```

**ì´ì „ ì‹¤íŒ¨ ì„¤ì •ê³¼ ë¹„êµ**:
- `5e-5`: ë„ˆë¬´ ë†’ì•„ì„œ ê°€ì¤‘ì¹˜ ë°œì‚° ì•¼ê¸°
- `3e-5`: ì ì ˆí•œ ìˆ˜ì¤€ìœ¼ë¡œ ì•ˆì •ì  í•™ìŠµ ê°€ëŠ¥

#### 2. í° ë°°ì¹˜ í¬ê¸°ì˜ íš¨ê³¼
```python
batch_size = 1024  # ì•ˆì •ì ì¸ ê·¸ë˜ë””ì–¸íŠ¸ ì¶”ì •
```

**íš¨ê³¼**:
- **ë…¸ì´ì¦ˆ ê°ì†Œ**: ë” ì¼ê´€ëœ í•™ìŠµ ì‹ í˜¸
- **ì•ˆì •ì„± í–¥ìƒ**: ê·¸ë˜ë””ì–¸íŠ¸ ë¶„ì‚° ê°ì†Œ
- **ìˆ˜ë ´ ê°œì„ **: ë” ë¶€ë“œëŸ¬ìš´ í•™ìŠµ ê³¡ì„ 

#### 3. ì¶©ë¶„í•œ í›ˆë ¨ ì—í”¼ì†Œë“œ
- **100 ì—í”¼ì†Œë“œ**: í™˜ê²½ ì ì‘ì— í•„ìš”í•œ ì¶©ë¶„í•œ ì‹œê°„
- **ë¸Œë ˆì´í¬ìŠ¤ë£¨ í¬ì¸íŠ¸**: Episode 41ì—ì„œ ê²°ì •ì  ê°œì„ 
- **ì ì§„ì  ìµœì í™”**: ì´í›„ ì§€ì†ì ì¸ ì„±ëŠ¥ í–¥ìƒ

### ê¸°ìˆ ì  í˜ì‹  ì‚¬í•­

#### Single-Process Architecture
```
Pre-trained G2P2C Agent
        â†“ (Live Instance Injection)
FastAPI Server (main_finetune.py)
        â†“ (Real-time Communication)
DMMS.R Simulator + JavaScript Plugin
        â†“ (Policy Updates)
Updated G2P2C Agent (Same Instance)
```

**ì¥ì **:
- **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**: ì²´í¬í¬ì¸íŠ¸ ë¡œë”© ì—†ì´ ì¦‰ì‹œ ì •ì±… ë°˜ì˜
- **í†µí•© ë©”ëª¨ë¦¬**: ì—ì´ì „íŠ¸ ìƒíƒœ ê³µìœ ë¡œ ì˜¤ë²„í—¤ë“œ ìµœì†Œí™”
- **ë””ë²„ê¹… ìš©ì´**: ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ì—ì„œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ ëª¨ë‹ˆí„°ë§

#### Command-line Hyperparameter Override
```bash
# ê¸°ì¡´: í•˜ë“œì½”ë”©ëœ ê°’ë§Œ ì‚¬ìš©
python run_extended_dmms_training.py --extended_episodes 30

# ê°œì„ : ìœ ì—°í•œ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì¡°ì •
python run_extended_dmms_training.py \
  --extended_episodes 100 \
  --pi_lr 3e-5 \
  --vf_lr 3e-5 \
  --batch_size 1024 \
  --dmms_cfg custom_patient.xml
```

### ìµœì¢… ì„±ëŠ¥ ì§€í‘œ

#### ì˜ˆì¸¡ ì •í™•ë„ (RMSE)
- **Actor**: `1.38 mg/dL` (ìš°ìˆ˜)
- **Critic**: `1.64 mg/dL` (ìš°ìˆ˜)
- **ê°œì„ ìœ¨**: ì´ˆê¸° ëŒ€ë¹„ **65-70% í–¥ìƒ**

#### ì„ìƒ ì„±ëŠ¥
- **TIR**: `100%` (ì™„ë²½)
- **Safety**: `0%` ì €í˜ˆë‹¹/ê³ í˜ˆë‹¹ (ì•ˆì „)
- **Stability**: ì¼ê´€ëœ í˜ˆë‹¹ ì œì–´ ì„±ëŠ¥

#### í•™ìŠµ ì•ˆì •ì„±
- **ìˆ˜ë ´ í™•ì¸**: Episode 41 ì´í›„ ì•ˆì •ì  ê°œì„ 
- **ì¬í˜„ì„±**: í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„¤ì • í‘œì¤€í™”
- **í™•ì¥ì„±**: ë‹¤ë¥¸ í™˜ìì—ê²Œ ì ìš© ê°€ëŠ¥í•œ ì„¤ì • í™•ë¦½

### í–¥í›„ ì—°êµ¬ ë°©í–¥

#### 1. ë‹¤ì¤‘ í™˜ì í™•ì¥
```bash
# ê²€ì¦ëœ ì„¤ì •ìœ¼ë¡œ ë‹¤ë¥¸ í™˜ìë“¤ í›ˆë ¨
python run_extended_dmms_training.py \
  --dmms_cfg adult_003_config.xml \
  --pi_lr 3e-5 --vf_lr 3e-5 --batch_size 1024

python run_extended_dmms_training.py \
  --dmms_cfg adult_008_config.xml \
  --pi_lr 3e-5 --vf_lr 3e-5 --batch_size 1024
```

#### 2. ìë™í™”ëœ ë‹¤ì¤‘ í™˜ì í›ˆë ¨
- `run_multi_patient_dmms_training.sh` ìŠ¤í¬ë¦½íŠ¸ ì™„ì„±
- ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„° ìë™ ì ìš©
- í™˜ìë³„ ì„±ëŠ¥ ë¹„êµ ë¶„ì„

#### 3. í•™ìˆ  ë…¼ë¬¸ ì‘ì„±
**ì£¼ìš” ê¸°ì—¬ì **:
- **Online Fine-tuning**: Simglucose â†’ DMMS.R ì‹¤ì‹œê°„ ì ì‘
- **Single-Process Architecture**: íš¨ìœ¨ì ì¸ ì‹¤ì‹œê°„ ì •ì±… ì—…ë°ì´íŠ¸
- **Hyperparameter Optimization**: DMMS.R í™˜ê²½ íŠ¹í™” ì„¤ì • ë°œê²¬
- **Clinical Validation**: 1-2 mg/dL RMSE + 100% TIR ë‹¬ì„±

### í”„ë¡œì íŠ¸ ìš”ì•½

#### ì¶œë°œì 
- ì‚¬ì „í›ˆë ¨ëœ G2P2C ì—ì´ì „íŠ¸ (Episode 195)
- ë‹¤ì¤‘ í™˜ì í›ˆë ¨ ìš”êµ¬ì‚¬í•­
- DMMS.R í™˜ê²½ìœ¼ë¡œì˜ ë¯¸ì„¸ì¡°ì • í•„ìš”ì„±

#### ì—¬ì •
1. **í™˜ì êµì²´ ë©”ì»¤ë‹ˆì¦˜ íƒêµ¬** â†’ DMMS.R ì œì•½ì‚¬í•­ ë°œê²¬
2. **Shell ìŠ¤í¬ë¦½íŠ¸ ê°œë°œ** â†’ ìˆœì°¨ í›ˆë ¨ ìë™í™”
3. **ì´ˆê¸° í›ˆë ¨ ì‹œë„** â†’ RMSE ë°œì‚° ë¬¸ì œ ë°œê²¬
4. **ê·¼ë³¸ ì›ì¸ ë¶„ì„** â†’ í•™ìŠµë¥  ê³¼ë‹¤ ë° ë°°ì¹˜ í¬ê¸° ë¶€ì¡±
5. **ìŠ¤í¬ë¦½íŠ¸ ê°œì„ ** â†’ ëª…ë ¹ì¤„ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì§€ì›
6. **ìµœì í™” ì‹¤í—˜** â†’ ì„±ê³µì ì¸ ì„¤ì • ë°œê²¬

#### ë„ì°©ì 
- **ì˜ˆì¸¡ ì •í™•ë„**: 1.38 mg/dL (ìš°ìˆ˜)
- **ì„ìƒ ì„±ëŠ¥**: 100% TIR + 0% ë¶€ì‘ìš©
- **í•™ìŠµ ì•ˆì •ì„±**: ì¬í˜„ ê°€ëŠ¥í•œ ë¸Œë ˆì´í¬ìŠ¤ë£¨ íŒ¨í„´
- **ê¸°ìˆ  í˜ì‹ **: ì‹¤ì‹œê°„ ì˜¨ë¼ì¸ ë¯¸ì„¸ì¡°ì • ì‹œìŠ¤í…œ

### í•µì‹¬ êµí›ˆ

1. **ë³´ìˆ˜ì  í•™ìŠµë¥ ì´ í•µì‹¬**: ì‚¬ì „í›ˆë ¨ëœ ëª¨ë¸ì—ëŠ” 3e-5 ìˆ˜ì¤€ ì í•©
2. **í° ë°°ì¹˜ í¬ê¸° í•„ìš”**: 1024ë¡œ ì•ˆì •ì  ê·¸ë˜ë””ì–¸íŠ¸ í™•ë³´
3. **ì¶©ë¶„í•œ í›ˆë ¨ ì‹œê°„**: 100 ì—í”¼ì†Œë“œì—ì„œ ë¸Œë ˆì´í¬ìŠ¤ë£¨ ë°œìƒ
4. **í™˜ê²½ë³„ ìµœì í™”**: DMMS.R íŠ¹ì„±ì„ ë°˜ì˜í•œ ì„¤ì • í•„ìˆ˜
5. **ì‹¤ì‹œê°„ ì•„í‚¤í…ì²˜**: Single-processê°€ íš¨ìœ¨ì ì´ê³  ì•ˆì •ì 

**ìµœì¢… ìµœì  ì„¤ì •**:
```bash
python experiments/run_extended_dmms_training.py \
  --extended_episodes 100 \
  --fine_tune_from_checkpoint 195 \
  --pi_lr 3e-5 \
  --vf_lr 3e-5 \
  --batch_size 1024 \
  --dmms_cfg {patient_config.xml}
```

---

## íŒŒì¼ ë° ê²°ê³¼ ìœ„ì¹˜

### ì£¼ìš” ìŠ¤í¬ë¦½íŠ¸
- **ë©”ì¸ í›ˆë ¨ ìŠ¤í¬ë¦½íŠ¸**: `experiments/run_extended_dmms_training.py`
- **ë‹¤ì¤‘ í™˜ì ìŠ¤í¬ë¦½íŠ¸**: `run_multi_patient_dmms_training.sh`
- **í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„¤ì •**: `agents/g2p2c/parameters.py`

### ì‹¤í—˜ ê²°ê³¼
- **30 ì—í”¼ì†Œë“œ**: `results/extended_dmms_30ep_20250607_154004/`
- **60 ì—í”¼ì†Œë“œ**: `results/extended_dmms_60ep_20250607_162625/`
- **100 ì—í”¼ì†Œë“œ (ì„±ê³µ)**: `results/extended_dmms_100ep_20250607_183216/`

### í™˜ì ì„¤ì •
- **ì„¤ì • ë””ë ‰í† ë¦¬**: `config/`
- **Adult #2**: `RL_scenario_1_07_13_19_50_adult2.xml`
- **Adult #8**: `RL_scenario_1_07_13_19_50_adult8.xml`

---

**2025ë…„ 6ì›” 7ì¼ í”„ë¡œì íŠ¸ ì™„ë£Œ**  
**ì„±ê³¼**: DMMS.R í™˜ê²½ì—ì„œ G2P2C ì—ì´ì „íŠ¸ì˜ ì„±ê³µì ì¸ ì˜¨ë¼ì¸ ë¯¸ì„¸ì¡°ì • ë‹¬ì„±